(this["webpackJsonpe-commerce"]=this["webpackJsonpe-commerce"]||[]).push([[0],{41:function(e,t,s){},67:function(e,t,s){"use strict";s.r(t);var a=s(1),c=s.n(a),n=s(33),r=s.n(n),i=(s(40),s(41),s(11)),l=s(10),o=s.n(l),d=s(19),j=s(13),u=s(14),h=s(16),b=s(15),m=s(8),x=s(2),O=s(17),p=s.n(O),v=s(34),f=s(9),g=c.a.createContext({}),N=s(0),k=function(e){return function(t){return Object(N.jsx)(g.Consumer,{children:function(s){return Object(N.jsx)(e,Object(i.a)(Object(i.a)({},t),{},{context:s}))}})}},C={name:"",price:"",stock:"",shortDesc:"",description:""},S=k(function(e){Object(h.a)(s,e);var t=Object(b.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).save=function(){var e=Object(d.a)(o.a.mark((function e(t){var s,c,n,r,i,l,d;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),s=a.state,c=s.name,n=s.price,r=s.stock,i=s.shortDesc,l=s.description,!c||!n){e.next=10;break}return d=Math.random().toString(36).substring(2)+Date.now().toString(36),e.next=6,p.a.post("http://localhost:3001/products",{id:d,name:c,price:n,stock:r,shortDesc:i,description:l});case 6:a.props.context.addProduct({name:c,price:n,shortDesc:i,description:l,stock:r||0},(function(){return a.setState(C)})),a.setState({flash:{status:"is-success",msg:"Product created successfully"}}),e.next=11;break;case 10:a.setState({flash:{status:"is-danger",msg:"Please enter name and price"}});case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a.handleChange=function(e){var t;return a.setState((t={},Object(f.a)(t,e.target.name,e.target.value),Object(f.a)(t,"error",""),t))},a.state=C,a}return Object(u.a)(s,[{key:"render",value:function(){var e=this.state,t=e.name,s=e.price,a=e.stock,c=e.shortDesc,n=e.description,r=this.props.context.user;return r&&r.accessLevel<1?Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"hero is-link ",children:Object(N.jsx)("div",{className:"hero-body container",children:Object(N.jsx)("h4",{className:"title",children:"Add Product"})})}),Object(N.jsx)("br",{}),Object(N.jsx)("br",{}),Object(N.jsx)("form",{onSubmit:this.save,children:Object(N.jsx)("div",{className:"columns is-mobile is-centered",children:Object(N.jsxs)("div",{className:"column is-one-third",children:[Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",children:"Product Name: "}),Object(N.jsx)("input",{className:"input",type:"text",name:"name",value:t,onChange:this.handleChange,required:!0})]}),Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",children:"Price: "}),Object(N.jsx)("input",{className:"input",type:"number",name:"price",value:s,onChange:this.handleChange,required:!0})]}),Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",children:"Available in Stock: "}),Object(N.jsx)("input",{className:"input",type:"number",name:"stock",value:a,onChange:this.handleChange})]}),Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",children:"Short Description: "}),Object(N.jsx)("input",{className:"input",type:"text",name:"shortDesc",value:c,onChange:this.handleChange})]}),Object(N.jsxs)("div",{className:"field",children:[Object(N.jsx)("label",{className:"label",children:"Description: "}),Object(N.jsx)("textarea",{className:"textarea",type:"text",rows:"2",style:{resize:"none"},name:"description",value:n,onChange:this.handleChange})]}),this.state.flash&&Object(N.jsx)("div",{className:"notification ".concat(this.state.flash.status),children:this.state.flash.msg}),Object(N.jsx)("div",{className:"field is-clearfix",children:Object(N.jsx)("button",{className:"button is-link is-outlined is-pulled-right",type:"submit",onClick:this.save,children:"Submit"})})]})})})]}):Object(N.jsx)(x.a,{to:"/"})}}]),s}(a.Component)),y=function(e){var t=e.cartItem,s=e.cartKey,a=t.product,c=t.amount;return Object(N.jsx)("div",{className:" column is-half",children:Object(N.jsx)("div",{className:"box",children:Object(N.jsxs)("div",{className:"media",children:[Object(N.jsx)("div",{className:"media-left",children:Object(N.jsx)("figure",{className:"image is-64x64",children:Object(N.jsx)("img",{src:"https://bulma.io/images/placeholders/128x128.png",alt:a.shortDesc})})}),Object(N.jsxs)("div",{className:"media-content",children:[Object(N.jsxs)("b",{style:{textTransform:"capitalize"},children:[a.name," ",Object(N.jsxs)("span",{className:"tag is-link",children:["$",a.price]})]}),Object(N.jsx)("div",{children:a.shortDesc}),Object(N.jsx)("small",{children:"".concat(c," in cart")})]}),Object(N.jsx)("div",{className:"media-right",onClick:function(){return e.removeFromCart(s)},children:Object(N.jsx)("span",{className:"delete is-large"})})]})})})},w=k((function(e){var t=e.context.cart,s=Object.keys(t||{});return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"hero is-link",children:Object(N.jsx)("div",{className:"hero-body container",children:Object(N.jsx)("h4",{className:"title",children:"My Cart"})})}),Object(N.jsx)("br",{}),Object(N.jsx)("div",{className:"container",children:s.length?Object(N.jsxs)("div",{className:"column columns is-multiline",children:[s.map((function(s){return Object(N.jsx)(y,{cartKey:s,cartItem:t[s],removeFromCart:e.context.removeFromCart},s)})),Object(N.jsxs)("div",{className:"column is-12 is-clearfix",children:[Object(N.jsx)("br",{}),Object(N.jsxs)("div",{className:"is-pulled-right",children:[Object(N.jsx)("button",{onClick:e.context.clearCart,className:"button is-warning ",children:"Clear cart"})," ",Object(N.jsx)("button",{className:"button is-success",onClick:e.context.checkout,children:"Checkout"})]})]})]}):Object(N.jsx)("div",{className:"column",children:Object(N.jsx)("div",{className:"title has-text-grey-light",children:"No item in cart!"})})})]})})),D=k(function(e){Object(h.a)(s,e);var t=Object(b.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).handleChange=function(e){var t;return a.setState((t={},Object(f.a)(t,e.target.name,e.target.value),Object(f.a)(t,"error",""),t))},a.login=function(e){e.preventDefault();var t=a.state,s=t.username,c=t.password;if(!s||!c)return a.setState({error:"Fill all fields!"});a.props.context.login(s,c).then((function(e){e||a.setState({error:"Invalid Credentails"})}))},a.state={username:"",password:""},a}return Object(u.a)(s,[{key:"render",value:function(){return this.props.context.user?Object(N.jsx)(x.a,{to:"/products"}):Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"hero is-link ",children:Object(N.jsx)("div",{className:"hero-body container",children:Object(N.jsx)("h4",{className:"title",children:"Login"})})}),Object(N.jsx)("br",{}),Object(N.jsx)("br",{}),Object(N.jsx)("form",{onSubmit:this.login,children:Object(N.jsx)("div",{className:"columns is-mobile is-centered",children:Object(N.jsxs)("div",{className:"column is-one-third",children:[Object(N.jsx)("div",{className:"field",children:Object(N.jsxs)("p",{class:"control has-icons-left has-icons-right",children:[Object(N.jsx)("input",{className:"input",type:"email",name:"username",placeholder:"Email",onChange:this.handleChange}),Object(N.jsx)("span",{class:"icon is-small is-left",children:Object(N.jsx)("i",{class:"fas fa-envelope"})}),Object(N.jsx)("span",{class:"icon is-small is-right",children:Object(N.jsx)("i",{class:"fas fa-check"})})]})}),Object(N.jsx)("div",{className:"field",children:Object(N.jsxs)("p",{class:"control has-icons-left has-icons-right",children:[Object(N.jsx)("input",{className:"input",type:"password",name:"password",placeholder:"Password",onChange:this.handleChange}),Object(N.jsx)("span",{class:"icon is-small is-left",children:Object(N.jsx)("i",{class:"fas fa-lock"})})]})}),this.state.error&&Object(N.jsx)("div",{className:"has-text-danger",children:this.state.error}),Object(N.jsx)("div",{className:"field is-clearfix",children:Object(N.jsx)("button",{className:"button is-link is-outlined is-pulled-right",children:"Submit"})})]})})})]})}}]),s}(a.Component)),P=function(e){var t=e.product;return Object(N.jsx)("div",{className:" column is-half",children:Object(N.jsx)("div",{className:"box",children:Object(N.jsxs)("div",{className:"media",children:[Object(N.jsx)("div",{className:"media-left",children:Object(N.jsx)("figure",{className:"image is-64x64",children:Object(N.jsx)("img",{src:"https://bulma.io/images/placeholders/128x128.png",alt:t.shortDesc})})}),Object(N.jsxs)("div",{className:"media-content",children:[Object(N.jsxs)("b",{style:{textTransform:"capitalize"},children:[t.name," ",Object(N.jsxs)("span",{className:"tag is-link",children:["$",t.price]})]}),Object(N.jsx)("div",{children:t.shortDesc}),t.stock>0?Object(N.jsx)("small",{children:t.stock+" Available"}):Object(N.jsx)("small",{className:"has-text-danger",children:"Out Of Stock"}),Object(N.jsx)("div",{className:"is-clearfix",children:Object(N.jsx)("button",{className:"button is-small is-outlined is-link   is-pulled-right",onClick:function(){return e.addToCart({id:t.name,product:t,amount:1})},children:"Add to Cart"})})]})]})})})},F=k((function(e){var t=e.context.products;return Object(N.jsxs)(N.Fragment,{children:[Object(N.jsx)("div",{className:"hero is-link",children:Object(N.jsx)("div",{className:"hero-body container",children:Object(N.jsx)("h4",{className:"title",children:"Our Products"})})}),Object(N.jsx)("br",{}),Object(N.jsx)("div",{className:"container",children:Object(N.jsx)("div",{className:"column columns is-multiline",children:t&&t.length?t.map((function(t,s){return Object(N.jsx)(P,{product:t,addToCart:e.context.addToCart},s)})):Object(N.jsx)("div",{className:"column",children:Object(N.jsx)("span",{className:"title has-text-grey-light",children:"No products found!"})})})})]})})),I=function(e){Object(h.a)(s,e);var t=Object(b.a)(s);function s(e){var a;return Object(j.a)(this,s),(a=t.call(this,e)).login=function(){var e=Object(d.a)(o.a.mark((function e(t,s){var c,n,r,i;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.a.post("http://localhost:3001/login",{email:t,password:s}).catch((function(e){return{status:401,message:"Unauthorized"}}));case 2:if(200!==(c=e.sent).status){e.next=11;break}return n=Object(v.a)(c.data.accessToken),r=n.email,i={email:r,token:c.data.accessToken,accessLevel:"admin@example.com"===r?0:1},a.setState({user:i}),localStorage.setItem("user",JSON.stringify(i)),e.abrupt("return",!0);case 11:return e.abrupt("return",!1);case 12:case"end":return e.stop()}}),e)})));return function(t,s){return e.apply(this,arguments)}}(),a.logout=function(e){e.preventDefault(),a.setState({user:null}),localStorage.removeItem("user")},a.addProduct=function(e,t){var s=a.state.products.slice();s.push(e),a.setState({products:s},(function(){return t&&t()}))},a.addToCart=function(e){var t=a.state.cart;t[e.id]?t[e.id].amount+=e.amount:t[e.id]=e,t[e.id].amount>t[e.id].product.stock&&(t[e.id].amount=t[e.id].product.stock),localStorage.setItem("cart",JSON.stringify(t)),a.setState({cart:t})},a.removeFromCart=function(e){var t=a.state.cart;delete t[e],localStorage.setItem("cart",JSON.stringify(t)),a.setState({cart:t})},a.clearCart=function(){localStorage.removeItem("cart"),a.setState({cart:{}})},a.checkout=function(){if(a.state.user){var e=a.state.cart,t=a.state.products.map((function(t){return e[t.name]&&(t.stock=t.stock-e[t.name].amount,p.a.put("http://localhost:3001/products/".concat(t.id),Object(i.a)({},t))),t}));a.setState({products:t}),a.clearCart()}else a.routerRef.current.history.push("/login")},a.state={user:null,cart:{},products:[]},a.routerRef=c.a.createRef(),a}return Object(u.a)(s,[{key:"componentDidMount",value:function(){var e=Object(d.a)(o.a.mark((function e(){var t,s,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("user"),s=localStorage.getItem("cart"),e.next=4,p.a.get("http://localhost:3001/products");case 4:a=e.sent,t=t?JSON.parse(t):null,s=s?JSON.parse(s):{},this.setState({user:t,products:a.data,cart:s});case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e=this;return Object(N.jsx)(g.Provider,{value:Object(i.a)(Object(i.a)({},this.state),{},{removeFromCart:this.removeFromCart,addToCart:this.addToCart,login:this.login,addProduct:this.addProduct,clearCart:this.clearCart,checkout:this.checkout}),children:Object(N.jsx)(m.a,{ref:this.routerRef,children:Object(N.jsxs)("div",{className:"App",children:[Object(N.jsxs)("nav",{className:"navbar container is-transparent",role:"navigation","aria-label":"main navigation",children:[Object(N.jsxs)("div",{className:"navbar-brand",children:[Object(N.jsx)("b",{className:"navbar-item is-size-4 ",children:"ecommerce"}),Object(N.jsxs)("label",{role:"button",class:"navbar-burger burger","aria-label":"menu","aria-expanded":"false","data-target":"navbarBasicExample",onClick:function(t){t.preventDefault(),e.setState({showMenu:!e.state.showMenu})},children:[Object(N.jsx)("span",{"aria-hidden":"true"}),Object(N.jsx)("span",{"aria-hidden":"true"}),Object(N.jsx)("span",{"aria-hidden":"true"})]})]}),Object(N.jsxs)("div",{className:"navbar-menu ".concat(this.state.showMenu?"is-active":""),children:[Object(N.jsx)(m.b,{to:"/products",className:"navbar-item",children:"Products"}),this.state.user&&this.state.user.accessLevel<1&&Object(N.jsx)(m.b,{to:"/add-product",className:"navbar-item",children:"Add Product"}),Object(N.jsxs)(m.b,{to:"/cart",className:"navbar-item",children:["Cart",Object(N.jsx)("span",{className:"tag is-link",style:{marginLeft:"5px"},children:Object.keys(this.state.cart).length})]}),this.state.user?Object(N.jsx)(m.b,{to:"/",onClick:this.logout,className:"navbar-item",children:"Logout"}):Object(N.jsx)(m.b,{to:"/login",className:"navbar-item",children:"Login"})]})]}),Object(N.jsxs)(x.d,{children:[Object(N.jsx)(x.b,{exact:!0,path:"/",component:F}),Object(N.jsx)(x.b,{exact:!0,path:"/login",component:D}),Object(N.jsx)(x.b,{exact:!0,path:"/cart",component:w}),Object(N.jsx)(x.b,{exact:!0,path:"/add-product",component:S}),Object(N.jsx)(x.b,{exact:!0,path:"/products",component:F})]})]})})})}}]),s}(a.Component),T=function(e){e&&e instanceof Function&&s.e(3).then(s.bind(null,68)).then((function(t){var s=t.getCLS,a=t.getFID,c=t.getFCP,n=t.getLCP,r=t.getTTFB;s(e),a(e),c(e),n(e),r(e)}))};r.a.render(Object(N.jsx)(c.a.StrictMode,{children:Object(N.jsx)(I,{})}),document.getElementById("root")),T()}},[[67,1,2]]]);
//# sourceMappingURL=main.e7b30f53.chunk.js.map